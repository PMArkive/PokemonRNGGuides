import{c as g,d as v,j as o,B as S,I as w,R as l,e as d,f as N,t as M,M as j,a as b,b as C,g as I,F as $,z as p,r as T,N as U}from"./index-DXZ5ShUP.js";import{R as y}from"./rngToolForm-B4hBWdo1.js";import{r as B}from"./range-BOnWQYcW.js";const P=["None","SuperPotion","FullHeal","UltraBall","RareCandy","FullRestore","Revive","Nugget","Protein","PpUp","KingsRock"],F=e=>g(e).with("None",()=>"None").with("SuperPotion",()=>"Super Potion").with("FullHeal",()=>"Full Heal").with("UltraBall",()=>"Ultra Ball").with("RareCandy",()=>"Rare Candy").with("FullRestore",()=>"Full Restore").with("Revive",()=>"Revive").with("Nugget",()=>"Nugget").with("Protein",()=>"Protein").with("PpUp",()=>"PP Up").with("KingsRock",()=>"King's Rock").otherwise(()=>"Unknown Item"),R=!0,E=!1,u=[26923,101199,101236],O=59.7275,f=1e3/O,m=p.enum(P),W=p.object({entered_hall_of_fame:p.boolean(),had_mass_outbreak:p.boolean(),pickup_pokemon_count:p.number().int().min(0).max(5),filter_active:p.boolean(),filter_pickup_items_0:m,filter_pickup_items_1:m,filter_pickup_items_2:m,filter_pickup_items_3:m,filter_pickup_items_4:m,initial_advance_before_pickup:p.number().int().min(0),calibration:p.number().int(),targetAdv:p.number().int()}),H={entered_hall_of_fame:!1,had_mass_outbreak:!1,pickup_pokemon_count:5,filter_active:!0,filter_pickup_items_0:"None",filter_pickup_items_1:"None",filter_pickup_items_2:"None",filter_pickup_items_3:"None",filter_pickup_items_4:"None",initial_advance_before_pickup:26800,calibration:0,targetAdv:26838},x=async e=>{const a=await T.get_target_advances_before_pickup(e.entered_hall_of_fame,e.had_mass_outbreak,R,E,e.pickup_pokemon_count);return a.length>0?a[0]:0},V=async e=>{const a=await x(e),_={initial_advance_before_pickup:e.filter_active?0:e.initial_advance_before_pickup,max_advances:11e4,entered_hall_of_fame:e.entered_hall_of_fame,can_have_new_mass_outbreak:!e.had_mass_outbreak,has_empty_pokenews_slot:R,pickup_pokemon_count:e.pickup_pokemon_count,level_up:E,filter_pickup_items:e.filter_active?[e.filter_pickup_items_0,e.filter_pickup_items_1,e.filter_pickup_items_2,e.filter_pickup_items_3,e.filter_pickup_items_4].slice(0,e.pickup_pokemon_count):null,filter_gives_pokerus:null},n=(await T.gen3_pokerus_generator_states(_)).map(t=>({...t,target_advance_before_pickup:a}));return e.filter_active?(n.sort((t,i)=>{const c=Math.abs(t.advance_before_pickup-t.target_advance_before_pickup),r=Math.abs(i.advance_before_pickup-i.target_advance_before_pickup);return c!==r?c-r:t.advance_before_pickup-i.advance_before_pickup}),n.slice(0,1e3)):n},K=({colValues:e,onClick:a})=>{const{values:_,setFieldValue:s}=v();return o.jsxs(S,{type:"text",color:"PrimaryText",trackerId:"pokerus_advance",onClick:()=>{const t=(e.advance_before_pickup-e.target_advance_before_pickup)/2*f;s("calibration",_.calibration-Math.round(t)),a()},children:[o.jsx(w,{name:"Update",size:20})," Update Calibration"]})},z=()=>{const{values:e,setFieldValue:a}=v(),_=l.useMemo(()=>{const t=e.targetAdv/2+506-800;return[5e3,Math.round(f*800),Math.round(f*t)+e.calibration]},[e.targetAdv,e.calibration]);l.useEffect(()=>{x({entered_hall_of_fame:e.entered_hall_of_fame,had_mass_outbreak:e.had_mass_outbreak,pickup_pokemon_count:e.pickup_pokemon_count}).then(n=>{a("targetAdv",n)})},[a,e.entered_hall_of_fame,e.had_mass_outbreak,e.pickup_pokemon_count]);const s=l.useMemo(()=>{const n=[{label:"Entered Hall of Fame",input:o.jsx(d,{name:"entered_hall_of_fame"})}];if(e.entered_hall_of_fame&&n.push({label:"Had Mass Outbreak",input:o.jsx(d,{name:"had_mass_outbreak"})}),n.push({label:"Number of Pickup Pokémon",input:o.jsx(N,{name:"pickup_pokemon_count",options:M(B(0,6)).toReversed()})},{label:"Target Advance",input:e.targetAdv>u[0]?`${e.targetAdv} (Not recommended)`:`${e.targetAdv}`},{label:"",direction:"column",input:o.jsx(j,{milliseconds:_,minutesBeforeTarget:3,startButtonTrackerId:"pokerus_timer_start",stopButtonTrackerId:"pokerus_timer_stop"})},{label:"Calibration (ms)",input:o.jsx(b,{name:"calibration",numType:"decimal"})},{label:"Filter?",input:o.jsx(d,{name:"filter_active"})}),e.filter_active||n.push({label:"Initial Advance",input:o.jsx(b,{name:"initial_advance_before_pickup",numType:"decimal"})}),e.filter_active){const t=P.map(r=>({label:F(r),value:r})),i=[["Filter: Pickup item obtained on 1st Pokémon","filter_pickup_items_0"],["Filter: Pickup item obtained on 2nd Pokémon","filter_pickup_items_1"],["Filter: Pickup item obtained on 3rd Pokémon","filter_pickup_items_2"],["Filter: Pickup item obtained on 4th Pokémon","filter_pickup_items_3"],["Filter: Pickup item obtained on 5th Pokémon","filter_pickup_items_4"]],c=Math.min(i.length,e.pickup_pokemon_count);for(let r=0;r<c;r++){const[k,A]=i[r];n.push({label:k,input:o.jsx(C,{name:A,options:t})})}}return n},[e.entered_hall_of_fame,e.filter_active,e.pickup_pokemon_count,_,e.targetAdv]);return o.jsx(I,{fields:s})},h=(e,a)=>{const _=e-a;return g(_).with(0,()=>`${e}`).with(U.when(s=>s>0),()=>`${e} (+${_})`).otherwise(()=>`${e} (${_})`)},Y=()=>{const[e,a]=l.useState([]),_=l.useCallback(async t=>{a(await V(t))},[a]),s=l.useCallback(()=>a([]),[a]),n=l.useMemo(()=>[{title:"Target (Pickup | Pokérus)",dataIndex:"target_advance_before_pickup",render:t=>{const i=t>u[0]?u[1]:u[0];return`${t} | ${i}`}},{title:"Hit (Pickup | Pokérus)",dataIndex:"advance_before_pickup",render:(t,i)=>{if(t===i.target_advance_before_pickup)return"Pokérus";const c=h(t,i.target_advance_before_pickup),r=i.target_advance_before_pickup>u[0]?u[1]:u[0],k=h(i.advance_before_pokerus,r);return`${c} | ${k}`}},{title:"",dataIndex:"advance_before_pokerus",render:(t,i)=>o.jsx(K,{colValues:i,onClick:s})},{title:"Pickup Items",dataIndex:"pickup_items",render:t=>{const i=t.map((c,r)=>c==="None"?null:`${r+1}: ${F(c)}`).filter(c=>c!=null);return i.length===0?"No items":i.join(", ")}}],[s]);return o.jsx($,{vertical:!0,children:o.jsx(y,{columns:n,results:e,initialValues:H,validationSchema:W,onSubmit:_,rowKey:"advance_before_pickup",submitTrackerId:"Pokerus3",children:o.jsx(z,{})})})};export{z as Fields,Y as Gen3Pokerus,K as UpdateCalibrationBtn};
