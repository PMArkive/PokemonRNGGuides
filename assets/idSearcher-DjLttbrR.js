import{u as g,s as b,a$ as F,R as m,r as R,c as p,N as j,j as s,z as l,d as k,g as N,aY as B,i as D,B as w,a as u,f as A,t as h,h as H,e as L,b as y}from"./index-DXZ5ShUP.js";import{R as Q}from"./rngToolForm-B4hBWdo1.js";import{u as J}from"./useBatchedTool-DMRJ-dEy.js";import{b as V,n as z}from"./pkmFilter-Dut2CP0u.js";import{s as E,a as $}from"./species-Be9kh-u_.js";import{a as P,I as Y}from"./id-Bad5r4ra.js";import"./ivs-DDKKiU8r.js";const q=[0,1,2],T=[{targetGender:"Female",natures:["Hardy","Lonely","Brave","Adamant","Naughty","Bold","Docile","Relaxed"],tsv:0},{targetGender:"Female",natures:["Impish","Lax","Timid","Hasty","Serious","Jolly","Naive","Modest"],tsv:1},{targetGender:"Female",natures:["Mild","Quiet","Bashful","Rash","Calm","Gentle","Sassy","Careful"],tsv:2},{targetGender:"Female",natures:["Quirky"],tsv:3},{targetGender:"Male",ratio:"OneToSeven",natures:["Hardy","Lonely","Brave","Adamant","Naughty","Bold"],tsv:6},{targetGender:"Male",ratio:"OneToSeven",natures:["Docile","Relaxed","Impish","Lax","Timid","Hasty","Serious","Jolly"],tsv:7},{targetGender:"Male",ratio:"OneToSeven",natures:["Naive","Modest","Mild","Quiet","Bashful","Rash","Calm","Gentle"],tsv:8},{targetGender:"Male",ratio:"OneToSeven",natures:["Sassy","Careful","Quirky"],tsv:9},{targetGender:"Male",ratio:"OneToThree",natures:["Hardy","Lonely","Brave","Adamant","Naughty"],tsv:9},{targetGender:"Male",ratio:"OneToThree",natures:["Bold","Docile","Relaxed","Impish","Lax","Timid","Hasty","Serious"],tsv:10},{targetGender:"Male",ratio:"OneToThree",natures:["Jolly","Naive","Modest","Mild","Quiet","Bashful","Rash","Calm"],tsv:11},{targetGender:"Male",ratio:"OneToThree",natures:["Gentle","Sassy","Careful","Quirky"],tsv:12},{targetGender:"Male",ratio:"OneToOne",natures:["Hardy","Lonely"],tsv:18},{targetGender:"Male",ratio:"OneToOne",natures:["Brave","Adamant","Naughty","Bold","Docile","Relaxed","Impish","Lax"],tsv:19},{targetGender:"Male",ratio:"OneToOne",natures:["Timid","Hasty","Serious","Jolly","Naive","Modest","Mild","Quiet"],tsv:20},{targetGender:"Male",ratio:"OneToOne",natures:["Bashful","Rash","Calm","Gentle","Sassy","Careful","Quirky"],tsv:21},{targetGender:"Male",ratio:"ThreeToOne",natures:["Hardy","Lonely","Brave","Adamant","Naughty","Bold","Docile","Relaxed"],tsv:25},{targetGender:"Male",ratio:"ThreeToOne",natures:["Impish","Lax","Timid","Hasty","Serious","Jolly","Naive","Modest"],tsv:26},{targetGender:"Male",ratio:"ThreeToOne",natures:["Mild","Quiet","Bashful","Rash","Calm","Gentle","Sassy","Careful"],tsv:27},{targetGender:"Male",ratio:"ThreeToOne",natures:["Quirky"],tsv:28}],U=({targetGender:e,ratio:n,nature:t})=>T.filter(a=>a.targetGender===e&&(a.ratio==null||n==null||a.ratio===n)&&(t!=null?a.natures.includes(t):!0)).map(({tsv:a})=>a),W=e=>{const n=T.filter(t=>t.tsv===e);return n.length===0?{targetGender:"Female",natures:[],genderRatios:[]}:{targetGender:n[0].targetGender,natures:n.flatMap(({natures:t})=>t),genderRatios:n.map(({ratio:t})=>t).filter(t=>t!=null)}},K=([e,n],t)=>{const a=[];for(let r=e;r<n;r+=t)a.push([r,Math.min(r+t,n)]);return a},_=["Cute Charm","Any TID"],x="Cute Charm",v=["Male","Female"],X=({target:e})=>{const[,n]=B(),[,t]=D();return s.jsx(w,{trackerId:"select_id4_target",onClick:()=>{n(a=>({...a,target:e})),t(a=>a+1)},children:"Select"})},Z=e=>p(e).with("FemaleOnly",()=>"0% Male").with("MaleOnly",()=>"100% Male").with("Genderless",()=>"Genderless").with("OneToOne",()=>"50% Male").with("OneToSeven",()=>"87.5% Male").with("OneToThree",()=>"75% Male").with("ThreeToOne",()=>"25% Male").with("SevenToOne",()=>"12.5% Male").exhaustive(),ee=({t:e,idType:n})=>{const t=[{title:e.Select,dataIndex:"seed",render:(r,d)=>s.jsx(X,{target:d})},{title:e.TID,dataIndex:"tid"},{title:e.SID,dataIndex:"sid"},{title:e.TSV,dataIndex:"tsv"}],a=[{title:e.Delay,dataIndex:"delay"},{title:e.Seconds,dataIndex:"seconds"}];return n==="Any TID"?[...t,...a]:[...t,{title:e["Target Gender"],dataIndex:"targetGender"},{title:e.Natures,dataIndex:"natures",render:r=>r.join(", ")},{title:e["Gender Ratios"],dataIndex:"genderRatios",render:r=>r.length===0?"All":r.map(Z).join(", ")},...a]},te=l.object({year:l.number().int().min(2e3).max(2100),min_delay:l.number().int().min(5e3),max_delay:l.number().int().min(5e3),id_type:l.enum(_),max_shiny_odds:l.boolean(),target_gender:l.enum(v),target_nature:l.enum(["None",...V]),target_species:l.enum(E),tid:l.number().int().min(0).max(65535).nullable(),force_second:l.number().int().min(0).max(59).nullable(),id_filter:Y}),M={year:2e3,min_delay:5e3,max_delay:5200,id_type:x,max_shiny_odds:!0,target_gender:"Female",target_nature:"None",target_species:"None",tid:null,force_second:null,id_filter:{type:"tid",value0:0,value1:null}},ae=({t:e,idType:n,maxShinyOdds:t,setValues:a})=>{const r=[{label:e.Year,input:s.jsx(u,{name:"year",numType:"decimal"})},{label:e["Min Delay"],input:s.jsx(u,{name:"min_delay",numType:"decimal"})},{label:e["Max Delay"],input:s.jsx(u,{name:"max_delay",numType:"decimal"})},{label:e["ID Type"],input:s.jsx(A,{name:"id_type",options:h(_)})}];return n==="Any TID"?[...r,{label:e.Filter,input:s.jsx(H,{name:"id_filter"})}]:[...r,{label:e["Max Shiny Odds"],input:s.jsx(L,{name:"max_shiny_odds",onChange:d=>{d&&a(M)}})},{label:e["Target Gender"],input:s.jsx(y,{name:"target_gender",options:h(v),disabled:t})},{label:e["Target Nature"],input:s.jsx(y,{name:"target_nature",options:z.required,disabled:t})},{label:e["Target Species"],input:s.jsx(y,{name:"target_species",options:$.byNameOptional,disabled:t})},{label:e["Optional TID"],input:s.jsx(u,{name:"tid",numType:"decimal"})},{label:e["Force Second"],input:s.jsx(u,{name:"force_second",numType:"decimal"})}]},ne=()=>{const e=g(),{values:n,setValues:t}=k(),a=n.max_shiny_odds,r=n.id_type,d=m.useMemo(()=>ae({t:e,idType:r,maxShinyOdds:a,setValues:t}),[e,r,a,t]);return s.jsx(N,{fields:d})},re=e=>({...e,seed:e.seed_time.seed,delay:e.seed_time.delay,seconds:e.seed_time.datetime.second,...W(e.tsv)}),ye=()=>{const e=g(),[n,t]=b.useMessage(),{run:a,data:r}=J(F.search_dppt_ids,{map:re}),[d,f]=m.useState(x),G=m.useCallback(async i=>{try{const o=i.max_shiny_odds?q:U({targetGender:i.target_gender,ratio:i.target_species==="None"?null:await R.get_species_gender_ratio(i.target_species),nature:i.target_nature==="None"?null:i.target_nature}),O=p(i).with({id_type:"Cute Charm",tid:null},()=>({Tsvs:o})).with({id_type:"Cute Charm",tid:j.not(null)},c=>({TidTsvs:{tid:c.tid,tsvs:o}})).with({id_type:"Any TID"},()=>P(i.id_filter)).exhaustive(),I=K([i.min_delay,i.max_delay],200).map(([c,C])=>({year:i.year,min_delay:c,max_delay:C,filter:O,force_second:i.force_second}));await a(I),f(i.id_type)}catch(o){n.error(`Error: ${o instanceof Error?o.message:"Unknown error"}`)}},[a,n]),S=m.useMemo(()=>ee({t:e,idType:d}),[e,d]);return s.jsxs(Q,{columns:S,results:r,initialValues:M,validationSchema:te,onSubmit:G,submitTrackerId:"search_dppt_id",children:[t,s.jsx(ne,{})]})};export{ye as Id4Searcher};
