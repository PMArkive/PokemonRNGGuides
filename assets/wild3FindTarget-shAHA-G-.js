import{u as K,a as T,R as o,j as i,F as L,T as C,b as P,c as R,p as Y,g as E,r as N,d as J,o as Q,e as X,f as l,t as d,h as Z,i as c,k as I,n as w,s as ee,l as te,m as A,q as ne,v as W,z as k,N as M,w as ae,x as f,y as m,A as p,_ as h,B as ie,C as se,D as re,E as oe,G as le}from"./index-CiP3hG4I.js";import{u as de,g as ue,f as $,a as z,b as ce,e as S,c as j,d as me,h as G,i as pe}from"./utils-B9m1m_ID.js";const V=["Wild1","Wild2","Wild3","Wild4","Wild5"],B=oe(!1),he=Q({species:h(se),tid:m().int().min(0).max(65535),sid:m().int().min(0).max(65535),maps:p(ie()),vanillaLead:f(),cuteCharmLeadGenders:p(h(j)),synchronizeLeadNatures:p(h(w)),encounterTypes:p(h(G)),methods:p(h(V)),initial_advances:m().int().min(0).max(4294967295),max_advances:m().int().min(0).max(4294967295),max_result_count:m().int().min(1),rngManipulatedLeadPid:f(),mergeSimilarResults:f(),generate_even_if_impossible:f()}).extend(re.shape).extend(pe.shape),_e=()=>({species:"Abra",tid:0,sid:0,maps:[],vanillaLead:!0,cuteCharmLeadGenders:[...j],synchronizeLeadNatures:[...w],methods:["Wild1","Wild2","Wild4"],encounterTypes:[...G],initial_advances:1e3,max_advances:1e5,max_result_count:1e4,rngManipulatedLeadPid:!1,mergeSimilarResults:!0,generate_even_if_impossible:!1,...te(),...me()}),ge=t=>{const n=le(E,t);return[{label:"Species",input:i.jsx(l,{name:"species",options:d(S.species)})},...X({gender:n}),...ce({max_size:Z(t)})]},v=t=>{var n;return Array.from(((n=S.speciesToEncounterInfo.get(t))==null?void 0:n.keys())??[])},D=t=>de(v(t).flatMap(n=>{var a;const e=(a=S.speciesToEncounterInfo.get(t))==null?void 0:a.get(n);return(e==null?void 0:e.map(s=>s.encounter_table.encounter_type))??[]})),xe=()=>{const[,t]=R(B);return i.jsx(I,{name:"rngManipulatedLeadPid",onChange:n=>{t(n)}})},be=(t,n)=>[{label:"Target Species",input:t},{label:"TID",input:i.jsx(c,{name:"tid",numType:"decimal",disabled:!n})},{label:"SID",input:i.jsx(c,{name:"sid",numType:"decimal",disabled:!n})},{label:"Maps",input:i.jsx(l,{name:"maps",options:d(v(t),z),mode:"multiple",fullWidth:!0,selectAllNoneButtons:!0})},{label:"Encounters",input:i.jsx(l,{name:"encounterTypes",options:d(D(t),$),mode:"multiple",fullWidth:!0,selectAllNoneButtons:!0})},{label:"Ordinary lead",input:i.jsx(I,{name:"vanillaLead"})},{label:"Synchronize leads",input:i.jsx(l,{name:"synchronizeLeadNatures",options:d(w),mode:"multiple",selectAllNoneButtons:!0})},{label:"Cute Charm leads",input:i.jsx(l,{name:"cuteCharmLeadGenders",options:d(j),mode:"multiple"})},{label:"Methods",input:i.jsx(l,{name:"methods",options:d(V),mode:"multiple"})},{label:"RNG-manipulated lead PID",input:i.jsx(xe,{})},{label:"Initial advances",input:i.jsx(c,{name:"initial_advances",numType:"decimal"})},{label:"Max advances",input:i.jsx(c,{name:"max_advances",numType:"decimal"})},{label:"Max result count",input:i.jsx(c,{name:"max_result_count",numType:"decimal"})},{label:"Merge similar results",input:i.jsx(I,{name:"mergeSimilarResults"})},{label:"Display results with 0% likelihood",input:i.jsx(I,{name:"generate_even_if_impossible"})}],fe=()=>{const{setFieldValue:t}=K(),n=T({name:"species"}),e=o.useMemo(()=>ge(n),[n]);return o.useEffect(()=>{t("maps",v(n)),t("encounterTypes",D(n))},[n,t]),i.jsxs(L,{vertical:!0,gap:8,children:[i.jsx(C.Title,{level:5,p:0,m:0,children:"Target PokÃ©mon"}),i.jsx(P,{fields:e})]})},ye=()=>{const t=T({name:"species"}),n=T({name:"filter_shiny"}),e=o.useMemo(()=>be(t,n),[t,n]);return i.jsxs(L,{vertical:!0,gap:8,children:[i.jsx(C.Title,{level:5,p:0,m:0,children:"Considered Setups"}),i.jsx(P,{fields:e})]})},y=(t,n)=>{const e=W(t.method_probability),a=t.pre_sweet_scent_cycle_range.start+t.pre_sweet_scent_cycle_range.len,s=a===0?`Method ${n} can't be triggered.`:`Method ${n} is triggered if the cycle counter at Sweet Scent is between ${t.pre_sweet_scent_cycle_range.start} and ${a}.`;return i.jsx(A,{title:s,children:i.jsx("div",{children:e})})},Ie=({rngManipulatedLeadPid:t})=>{const n=[];return n.push({title:"Advances",dataIndex:"advance",monospace:!0,render:e=>{const a=(e/59.7275/60).toFixed(1);return i.jsx(A,{title:`~${a} min`,children:i.jsx("div",{children:ne(e)})})}},{title:"Map",dataIndex:"mapName"},{title:"Encounter",dataIndex:"encounterTypeName"},{title:"Method",dataIndex:"method"}),t||n.push({title:i.jsxs(i.Fragment,{children:["Method ",i.jsx("br",{}),"Likelihood"]}),key:"<>Method <br />Likelihood</>",dataIndex:"cycle_data_by_lead",render:e=>{if(e==null)return"";const a=e.common_lower_lead.method_probability<e.common_upper_lead.method_probability?e.common_lower_lead:e.common_upper_lead;return W(a.method_probability)}}),n.push({title:"Lead",dataIndex:"lead",render:e=>k(e).with("Vanilla",()=>"Ordinary lead").with({Synchronize:M.string},a=>`Synchronize (${a.Synchronize})`).with({CuteCharm:M.string},a=>`CuteCharm (${a.CuteCharm})`).with("Egg",()=>"Egg lead").exhaustive()}),t&&n.push({title:"Ideal Lead Speed",dataIndex:"cycle_data_by_lead",render:(e,a)=>{if(e==null||a.lead==="Egg")return"";if(e.ideal_lead.method_probability===e.slowest_lead.method_probability&&e.ideal_lead.method_probability===e.fastest_lead.method_probability)return"Any";const s=e.ideal_lead.lead_pid_cycle_count;return k(s).with(18,()=>"Fastest").with(900,()=>"Slowest").with(M.number,()=>s+" cycles").exhaustive()}},{title:"Method Likelyhood by Lead Speed",type:"group",columns:[{title:"Ideal",dataIndex:"cycle_data_by_lead",render:(e,a)=>e==null?"":y(e.ideal_lead,a.method)},{title:"Fastest",dataIndex:"cycle_data_by_lead",render:(e,a)=>e==null?"":y(e.fastest_lead,a.method)},{title:"Common",dataIndex:"cycle_data_by_lead",render:(e,a)=>{if(e==null)return"";const s=e.common_lower_lead.method_probability<e.common_upper_lead.method_probability?e.common_lower_lead:e.common_upper_lead;return y(s,a.method)}},{title:"Slowest",dataIndex:"cycle_data_by_lead",render:(e,a)=>e==null?"":y(e.slowest_lead,a.method)}]}),n.push({title:"Species",dataIndex:"species"},{title:"PID",dataIndex:"pid",monospace:!0,render:e=>e.toString(16).padStart(8,"0").toUpperCase()},{title:"Nature",dataIndex:"nature"},{title:"Ability",dataIndex:"ability"},{title:"Shiny",dataIndex:"shiny",render:e=>e?"Yes":"No"},{title:"Gender",dataIndex:"gender"},...ae,{title:"Hidden Power",type:"group",columns:[{title:"Type",dataIndex:"hidden_power",render:e=>e.pokemon_type},{title:"Power",dataIndex:"hidden_power",render:e=>e.bp}]},{title:"PID speed",dataIndex:"pidCycleCount",render:e=>`${e} cycles`}),n},Se=t=>{const n=[];t.vanillaLead&&n.push("Vanilla");for(const e of t.synchronizeLeadNatures)n.push({Synchronize:e});return n},Me=t=>{if(t.species==="None")return[];const n=t.maps,e=t.encounterTypes,a=S.speciesToEncounterInfo.get(t.species);if(a===void 0)return[];const s=[];return a.forEach((_,g)=>{n.includes(g)&&_.forEach(x=>{e.includes(x.encounter_table.encounter_type)&&s.push([g,x])})}),s};let Te=0;const we=async(t,n,e,a)=>({...t,...t.ivs,mapName:e,encounterTypeName:a,species:n,uid:Te++,pidCycleCount:await N.calculate_pid_speed(t.pid)}),je=t=>{const n=new Map;return t.forEach(e=>{const a=`${e.pid},${e.ivs.hp},${e.ivs.atk},${e.ivs.def},${e.ivs.spa},${e.ivs.spd},${e.ivs.spe}`,s=n.get(a);(s===void 0||s.lead!=="Vanilla"&&e.lead==="Vanilla")&&n.set(a,e)}),Array.from(n.values())},ve=t=>ee(t,["advance","method","map_idx"]),Le=({game:t})=>{const[n,e]=o.useState([]),[a]=R(B),s=t==="emerald"?0:1440,_=o.useCallback(async r=>{const F=Me(r),O={initial_seed:s,tid:r.tid,sid:r.sid,gender_ratio:E[r.species],initial_advances:r.initial_advances,max_advances:r.max_advances,max_result_count:r.max_result_count,filter:Y(r),gen3_filter:ue(r),leads:Se(r),encounter_info_by_map:F.map(b=>b[1]),methods:r.methods,consider_cycles:!0,consider_rng_manipulated_lead_pid:r.rngManipulatedLeadPid,generate_even_if_impossible:r.generate_even_if_impossible};let u=await N.search_wild3(O);r.mergeSimilarResults&&(u=je(u)),u=ve(u);const U=await Promise.all(u.map(b=>{const[q,H]=F[b.map_idx];return we(b,r.species,z(q),$(H.encounter_table.encounter_type))}));e(U)},[s]),g=o.useMemo(()=>_e(),[]),x=o.useMemo(()=>Ie({rngManipulatedLeadPid:a}),[a]);return i.jsxs(J,{columns:x,results:n,validationSchema:he,initialValues:g,onSubmit:_,submitTrackerId:"wild3_find_target",rowKey:"uid",children:[i.jsx(fe,{}),i.jsx("br",{}),i.jsx(ye,{})]})};export{ye as SetupFilter,fe as TargetMon,Le as Wild3SearcherFindTarget};
