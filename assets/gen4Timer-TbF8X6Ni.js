import{R as o,bh as j,O as x,j as f,F as M,M as A,bi as F}from"./index-DXZ5ShUP.js";const B=({enableAudio:m,tickStart:s,tickEnd:t})=>{const[r,l]=o.useState(0),[u,a]=o.useState(!1),[n,i]=o.useState(!1),e=o.useRef(-1),{playBeeps:R}=j({id:"softBeep"}),p=R;return o.useEffect(()=>{n||(e.current=-1)},[n]),o.useEffect(()=>{let c=null;const T=()=>{const d=performance.timeOrigin+performance.now(),b=Math.floor(d%1e3),g=Math.floor(d/1e3);if(b>=r&&g!==e.current){const _=e.current===-1;e.current=g,_||(s==null||s(),a(!0),p({count:1,gain:.1}),setTimeout(()=>{t==null||t(),a(!1)},100))}c=requestAnimationFrame(T)};return c=n?requestAnimationFrame(T):null,()=>{c!=null&&cancelAnimationFrame(c)}},[p,r,s,t,n]),{offset:r,isRunning:n,justTicked:u,runMetronome:i,setOffset:l}},G=({selfInit:m=!0,trackerId:s,targetDelay:t,targetSecond:r,timer:l,is3ds:u,fields:a})=>{const{ms:n,initTimer:i}=x(l),e=B({enableAudio:!0});return o.useEffect(()=>{m&&i({min_time_ms:u?55e3:14e3,calibrated_delay:600,calibrated_second:14,target_delay:t,target_second:r})},[m,i,t,r,u]),f.jsxs(M,{vertical:!0,gap:12,children:[f.jsx(A,{milliseconds:n,disableStart:u&&!e.isRunning||e.isRunning&&!e.justTicked,startButtonTrackerId:`${s}_start`,stopButtonTrackerId:`${s}_stop`}),u&&f.jsx(F,{...e}),a]})};export{G};
