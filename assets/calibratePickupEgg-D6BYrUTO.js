import{k as $,R as d,j as o,F as w,p as h,v as I,l as D,r as P,q as U,K as A,c as T,N as m,by as J}from"./index-DXZ5ShUP.js";import{R as Q}from"./rngToolForm-B4hBWdo1.js";import{f as W,C as X}from"./offsetSymbol-BhtzUnCn.js";import{a as Y,b as M}from"./state-CFkWkYUl.js";import{m as Z,a as tt}from"./ivs-DDKKiU8r.js";import{n as et}from"./ivColumns-Co1n9lOk.js";import{a as at,b as st}from"./statRange-CwxZmFOq.js";import{g as nt}from"./statFields-BqJvJlc9.js";import{i as rt,n as it}from"./pkmFilter-Dut2CP0u.js";import{p as R}from"./index-DYfrB5EN.js";import{c as ot}from"./useGen3Timer-D-oFIk24.js";import{i as ct}from"./constants-Bv2wZiBa.js";import{G as dt}from"./gen3Timer-Ip2_9jlj.js";import{g as pt}from"./species-Be9kh-u_.js";import"./range-BOnWQYcW.js";const lt=D({species:"Bulbasaur",nature:"Hardy"}),S=()=>$(lt),mt=()=>{const[t,s]=S();return o.jsx(A,{name:"species",options:pt.byName,value:t.species,onChange:n=>s(c=>({...c,species:n}))})},ut=()=>{const[t,s]=S();return o.jsx(A,{name:"nature",options:it.required,value:t.nature,onChange:n=>s(c=>({...c,nature:n}))})},i=t=>T(t).with({Random:m.number},()=>!0).with({Parent1:m.number},()=>!0).with({Parent2:m.number},()=>!0).with({Parent1:void 0},()=>!1).with({Parent2:void 0},()=>!1).exhaustive(),C=({iv:t,ivDefault:s})=>T(t).with({Random:m.number},n=>n.Random).with({Parent1:m.number},n=>n.Parent1).with({Parent2:m.number},n=>n.Parent2).with({Parent1:void 0},()=>s).with({Parent2:void 0},()=>s).exhaustive(),gt=t=>J(t,s=>C({iv:s,ivDefault:31})),H=ot(),vt=[{title:"Calibrate",dataIndex:"advance",render:(t,s)=>o.jsx(X,{type:"gen3",hitAdvance:s.advance,timer:H,trackerId:"calibrate_retail_emerald_pickup_egg"})},{title:"Offset",dataIndex:"offset",render:W},{title:"Method",dataIndex:"method",render:t=>I(t)},...et],ft=async t=>(await R(ct,async n=>(await P.emerald_egg_pickup_states({method:n,seed:t.seed,parent_ivs:t.parentIvs,initial_advances:Math.max(t.targetAdvance-100,0),lua_adjustment:!0,max_advances:200,delay:0,filter:{min_ivs:tt,max_ivs:Z}})).map(u=>({...u,method:n})),{concurrency:3})).flat(),j={hpStat:0,atkStat:0,defStat:0,spaStat:0,spdStat:0,speStat:0},Rt=()=>{var _;const[t]=Y(),[s,n]=S(),[c]=M(),[u,x]=d.useState([]),[p,F]=d.useState(j),y=t.eggSettings.egg_species,b=((_=t.target)==null?void 0:_.nature)??"Hardy";d.useEffect(()=>{n({species:y,nature:b})},[y,b,n]);const[k,N]=d.useState(rt),g=s.species,E=s.nature,f=c.targetAdvance;d.useEffect(()=>{(async()=>{const v=await at(g);N(v)})()},[g]),d.useEffect(()=>{(async()=>{const v=st(g);if(v==null){x([]);return}const V=await ft(c),q=await R(V,async r=>{const l=await P.calculate_stats(v,5,E,gt(r.ivs),{hp:0,atk:0,def:0,spa:0,spd:0,spe:0});return{key:`${r.advance}-${r.method}`,advance:r.advance,offset:r.advance-f,method:r.method,ivs:r.ivs,hp:i(r.ivs.hp)?l.hp:null,atk:i(r.ivs.atk)?l.atk:null,def:i(r.ivs.def)?l.def:null,spa:i(r.ivs.spa)?l.spa:null,spd:i(r.ivs.spd)?l.spd:null,spe:i(r.ivs.spe)?l.spe:null}}),L=U(q,r=>r.advance);x(L)})()},[c,f,g,E]);const B=d.useMemo(()=>[{label:"Species",input:o.jsx(mt,{})},{label:"Nature",input:o.jsx(ut,{})},...nt(k)],[k]),O=d.useMemo(()=>u.filter(e=>(e.hp===p.hpStat||!i(e.ivs.hp))&&(e.atk===p.atkStat||!i(e.ivs.atk))&&(e.def===p.defStat||!i(e.ivs.def))&&(e.spa===p.spaStat||!i(e.ivs.spa))&&(e.spd===p.spdStat||!i(e.ivs.spd))&&(e.spe===p.speStat||!i(e.ivs.spe))),[u,p]),z=d.useCallback(async e=>F(e),[]),a=u.find(e=>e.advance===f&&e.method===c.targetMethod),G=a==null?"Unknown":[a.hp??"?",a.atk??"?",a.def??"?",a.spa??"?",a.spd??"?",a.spe??"?"].join(" / "),K=a==null?null:[a.ivs.hp,a.ivs.atk,a.ivs.def,a.ivs.spa,a.ivs.spd,a.ivs.spe].map(e=>C({iv:e,ivDefault:"?"})).join(" / ");return o.jsxs(w,{vertical:!0,gap:16,width:"100%",children:[o.jsxs(w,{vertical:!0,gap:8,children:[o.jsxs(h.Title,{level:5,mv:0,children:["Target Method: ",I(a==null?void 0:a.method)]}),o.jsxs(h.Title,{level:5,mv:0,children:["Target Stats: ",G]}),o.jsxs(h.Title,{level:5,mv:0,children:["Target IVs: ",K]})]}),o.jsx(Q,{fields:B,columns:vt,results:O,initialValues:j,onSubmit:z,submitTrackerId:"generate_retail_emerald_pickup_egg",submitButtonLabel:"Find advances matching hatched egg",rowKey:"key"})]})},Ct=()=>{const[t]=M(),s=t.targetAdvance;return o.jsx(dt,{trackerId:"retail_emerald_pickup_egg",targetAdvance:s,timer:H})};export{Rt as CalibratePickupEgg,Ct as CalibratePickupEggTimer};
